webpackJsonp([47],{"5FKq":function(e,t,a){"use strict";a.d(t,"a",function(){return i}),a.d(t,"b",function(){return r});var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.showError?a("div",{staticClass:"error"},[a("div",{staticClass:"errorMsg"},[a("h5",[e._v(e._s(e.errorMsg))]),a("p",[a("span",{on:{click:e.reload}},[e._v("刷新")]),a("span",{on:{click:e.getPlayerInfo}},[e._v("重试")])])])]):e._e()},r=[];i._withStripped=!0},CGnF:function(e,t,a){"use strict";t.a={props:["showError","errorMsg"],methods:{reload:function(){window.location.reload()},getPlayerInfo:function(){this.$emit("getPlayerInfo")}}}},GpD0:function(e,t,a){var i=a("ricX");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals),a("rjj0")("4f97ec52",i,!1,{sourceMap:!1})},KVpI:function(e,t,a){"use strict";var i=a("Dd8w"),r=a.n(i),l=a("NYxO"),o=a("SL1N"),s=a("lHEt"),n=a("v/8m"),p=a("ygf3"),c=a("o/Ov"),u=a("c8EJ");t.a={components:{"v-error":u.a},props:["playerForm","isloaded","playerInner","isFreeCourse","bought"],data:function(){return{isTrySee:!1,isTrySeeTime:0,clickTime:"",showError:!1,projectForm:{ids:""},playerPreviousForm:{curriculumId:"",catalogId:""},playerNextForm:{curriculumId:"",catalogId:""},index:0,playImg:"http://static-image.1911edu.com/playImg.gif",pauseImg:"http://static-image.1911edu.com/video.png",autoplay:!1,aliPlayer:{id:"mediaPlayer",width:"100%",height:"100%",autoplay:!1,vid:"",playauth:"",isLive:!1,components:[{name:"playerNextComponent",type:p.a,args:[this.nextVideo]},{name:"playerPreviousComponent",type:c.a,args:[this.previousVideo]}]},player:"",socket:"",playAuthInfo:{},pay:{type:2},shoppingForm:{cartid:"",type:2},course:{catalogId:"",curriculumId:""},node:"",errorMsg:"",playLoading:"",loadingFlag:!0,playVideo:!1}},methods:r()({},Object(l.mapActions)("auth",["signOut"]),Object(l.mapMutations)("auth",["setClosePay"]),{gobuy:function(){this.$emit("gobuy")},closeTip:function(){this.isTrySee=!1},getPlayerInfo:function(){var e=this,t=this;this.socket=new io(Object(n.f)()),this.socket.on("connect",function(){t.socket.emit("login",s.a.get("token"))}),this.socket.on("new_msg",function(e){if("0"==e.pay_status&&t.$bus.$emit("payResult",!0),100100==e.pay_status)return t.$bus.$emit("payResult",!1),!1}),this.socket.on("reconnect",function(e){}),o.E.getPlayerInfos(this.playerForm).then(function(a){0===a.status?(e.changePlayImg(e.pauseImg,e.playerForm.catalogId),t.bought||"1"!=a.data.is_free||a.data.playAuthInfo.is_try_see?(e.course.curriculumId=e.playerForm.curriculumId,e.course.catalogId=e.playerForm.catalogId,e.playAuthInfo=a.data.playAuthInfo,e.aliPlayer.vid=a.data.playAuthInfo.video_id,e.aliPlayer.playauth=a.data.playAuthInfo.playAuth,e.player&&(e.player.dispose(),e.$refs.playInner.insertBefore(e.node,e.$refs.playVideo)),e.player=new Aliplayer(e.aliPlayer),e.loadingFlag&&(e.loadingFlag=!1,e.playLoading=setInterval(function(){e.playerLoad()},500)),e.playerNextForm.curriculumId=a.data.nextCurriculumId,e.playerNextForm.catalogId=a.data.nextCatalogId,e.playerPreviousForm.curriculumId=a.data.previousCurriculumId,e.playerPreviousForm.catalogId=a.data.previousCatalogId,e.player.on("ready",e.readyPlay),e.player.on("play",e.playerPlay),e.player.on("pause",e.playerPause),e.player.on("completeSeek",e.changeSeek),e.player.on("requestFullScreen",e.fullScreenTrue),e.player.on("cancelFullScreen",e.exitFullScreen),e.player.on("ended",e.playerEnded),e.player.on("error",e.playerError)):(e.$emit("buyProject"),e.playerForm.curriculumId=e.course.curriculumId,e.playerForm.catalogId=e.course.catalogId),!t.bought&&a.data.playAuthInfo.is_try_see?(e.isTrySee=!0,e.isTrySeeTime=Math.round(a.data.playAuthInfo.free_time/60*100)/100):e.isTrySee=!1):(Object(n.i)(e,"error",a.msg),e.playerForm.curriculumId=e.course.curriculumId,e.playerForm.catalogId=e.course.catalogId)})},playerLoad:function(){document.getElementsByClassName("prism-hide")[0]&&(document.getElementsByClassName("prism-hide")[0].className="prism-loading")},readyPlay:function(){clearInterval(this.playLoading),this.playerLoad(),this.loadingFlag=!0,this.aliPlayer.autoplay?(this.playVideo=!1,this.player.play()):this.playVideo=!0,this.bought&&0!=this.playerForm.seek&&(this.player.seek(this.playerForm.seek),this.playerForm.seek=0),this.keyboard()},playerPlay:function(){var e=this;this.playVideo=!1,clearInterval(this.playLoading);var t=this;clearInterval(this.interval),this.interval=setInterval(function(){if(e.seconds<=0)e.seconds=1,e.courseList.success=!1,e.courseList.inputID="",t.socket.emit("watchRecordingTime_disconnect"),clearInterval(e.interval);else{e.seconds--;var a=e.player.getCurrentTime();e.playAuthInfo.is_try_see&&e.preview(e.playAuthInfo.free_time,a),t.socket.emit("watchRecordingTime",e.playerForm.curriculumId,e.playerForm.catalogId,a,e.projectForm.ids,2),"playing"==e.player.getStatus()?e.playVideo=!1:e.playVideo=!0}},1e3),this.changePlayImg(this.playImg,this.playerForm.catalogId)},playerPause:function(){this.playVideo=!0,this.player.pause(),this.changePlayImg(this.pauseImg,this.playerForm.catalogId),clearInterval(this.interval),this.socket.emit("watchRecordingTime_disconnect")},changeSeek:function(e){if(!(!this.bought&&this.playAuthInfo.is_try_see&&e.paramData>this.playAuthInfo.free_time))return this.playVideo=!1,!1;this.playerEnded()},playerEnded:function(){this.playVideo=!0,clearInterval(this.interval),!this.bought&&this.playAuthInfo.is_try_see?(this.player.fullscreenService.cancelFullScreen(),this.changePlayImg(this.pauseImg,this.playerForm.catalogId),this.$bus.$emit("openPay",this.pay),this.closePayed()):(""!==this.nextCatalogId&&this.bought&&(this.aliPlayer.autoplay=!0,this.playVideo=!1,this.nextVideo()),""==this.nextCatalogId&&this.bought&&(this.changePlayImg(this.pauseImg,this.playerForm.catalogId),clearInterval(this.interval),this.socket.emit("watchRecordingTime_disconnect")))},playerError:function(e){this.showError=!0,this.errorMsg=e.paramData.display_msg},preview:function(e,t){Number(e)<Number(t)&&(this.index++,this.player.pause(),clearInterval(this.interval),this.index<2&&this.playerEnded())},previousVideo:function(){""!==this.playerPreviousForm.curriculumId?(this.playerForm.curriculumId=this.playerPreviousForm.curriculumId,this.playerForm.catalogId=this.playerPreviousForm.catalogId,this.aliPlayer.autoplay=!0,this.playVideo=!1,this.getPlayerInfo()):Object(n.i)(this,"warning","已经是第一节了！")},nextVideo:function(){""!==this.playerNextForm.curriculumId?(this.playerForm.curriculumId=this.playerNextForm.curriculumId,this.playerForm.catalogId=this.playerNextForm.catalogId,this.aliPlayer.autoplay=!0,this.playVideo=!1,this.getPlayerInfo()):Object(n.i)(this,"warning","已经是最后一节了！")},handleCourse:function(e){if(this.playerForm.catalogId===e.id)return!1;this.playerForm.curriculumId=e.curriculum_id,this.playerForm.catalogId=e.id,clearInterval(this.interval),this.aliPlayer.autoplay=!0,this.getPlayerInfo()},changePlayImg:function(e,t){this.$emit("changePlayImg",e,t)},isPlay:function(){this.player&&this.player.play()},isPause:function(){this.player&&this.player.pause()},playMedia:function(e){var t=this;clearTimeout(this.clickTime),this.clickTime=setTimeout(function(){navigator.userAgent.indexOf("Firefox")>-1?t.player&&"mediaPlayer"==e.target.offsetParent.id&&(t.playVideo?t.player.play():t.player.pause()):t.player&&"mediaPlayer"==e.path[1].id&&(t.playVideo?t.player.play():t.player.pause())},300)},dblclick:function(e){if(clearTimeout(this.clickTime),this.player&&"mediaPlayer"==e.path[1].id)if(this.player.fullscreenService.getIsFullScreen()){document.getElementsByClassName("prism-big-play-btn")[0].style.visibility="hidden",this.player.fullscreenService.cancelFullScreen()}else{document.getElementsByClassName("prism-big-play-btn")[0].style.visibility="visible",this.player.fullscreenService.requestFullScreen()}},fullScreenTrue:function(){document.getElementsByClassName("prism-big-play-btn")[0].style.visibility="visible",this.fullScreen=!0},exitFullScreen:function(){document.getElementsByClassName("prism-big-play-btn")[0].style.visibility="hidden",Object(n.d)()},keyboard:function(){var e=this;window.onkeydown=function(t){32==t.keyCode&&e.player&&(e.playVideo?e.player.play():e.player.pause()),37==t.keyCode&&e.speedRetreat(),39==t.keyCode&&e.speedAdvance(),38==t.keyCode&&e.volumeUp(),40==t.keyCode&&e.volumeDown()}},speedRetreat:function(){this.player.seek(1*this.player.getCurrentTime()-5)},speedAdvance:function(){this.player.getDuration()-this.player.getCurrentTime()>5&&this.player.seek(1*this.player.getCurrentTime()+5)},volumeUp:function(){var e=this.player.getVolume();e=e>.9?1:e+.1,this.player.setVolume(e)},volumeDown:function(){var e=this.player.getVolume();e=e<.1?0:e-.1,this.player.setVolume(e)},closePayed:function(){this.aliPlayer.autoplay=!1,this.index=0,this.player.seek(0),this.getPlayerInfo(),this.setClosePay({closePay:!1})},action:function(){this.player&&("pause"!=this.player.getStatus()&&"loading"!=this.player.getStatus()&&"ready"!=this.player.getStatus()&&"ended"!=this.player.getStatus()||(this.player.play(),this.playVideo=!1),"playing"==this.player.getStatus()&&(this.player.pause(),this.playVideo=!0))}}),watch:{isloaded:function(e,t){e&&(this.getPlayerInfo(),this.$emit("falseLoaded"))},playerInner:function(e,t){this.$refs.playInner.style.height=e+"px"},closePay:function(e){e&&this.closePayed()}},mounted:function(){var e=this;this.projectForm.ids=Object(n.h)("kid"),this.$bus.$on("clickCatalog",function(t){e.handleCourse(t)}),this.node=this.$refs.mediaPlayer}}},c8EJ:function(e,t,a){"use strict";var i=a("CGnF"),r=a("5FKq"),l=a("XyMi"),o=!1,s=function(e){o||a("pIix")},n=Object(l.a)(i.a,r.a,r.b,!1,s,"data-v-aa4ca744",null);n.options.__file="components/common/PlayerError.vue",t.a=n.exports},himT:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("KVpI"),r=a("uiQa"),l=a("XyMi"),o=Object(l.a)(i.a,r.a,r.b,!1,null,null,null);o.options.__file="pages/project/projectPlayer/player.vue",t.default=o.exports},"o/Ov":function(e,t,a){"use strict";var i=a("Zrlr"),r=a.n(i),l=a("wxAW"),o=a.n(l),s=a("GpD0"),n=(a.n(s),function(){function e(t){r()(this,e),this.clickHandle=t,this.$html=$('<div class="player-olympic-player-previous"><div class="player-olympic-player-previous-tip">上一节</div></div>')}return o()(e,[{key:"createEl",value:function(e){this.$html.click(this.clickHandle),$(e).find(".prism-play-btn").after(this.$html)}}]),e}());t.a=n},pIix:function(e,t,a){var i=a("vNYA");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals),a("rjj0")("0da13a34",i,!1,{sourceMap:!1})},ricX:function(e,t,a){(e.exports=a("FZ+f")(!1)).push([e.i,'.player-olympic-player-next{width:24px;height:28px;background:url("http://static-image.1911edu.com/next.png") 50% no-repeat;background-size:contain;float:left;margin-left:15px;margin-top:12px;cursor:pointer;position:relative}.player-olympic-player-next-tip{position:absolute;top:-45px;display:none;font-size:12px;color:#fff;line-height:28px;letter-spacing:0;text-align:center;background:#3c3c3c;-webkit-box-shadow:0 0 5px 0 rgba(0,0,0,.1);box-shadow:0 0 5px 0 rgba(0,0,0,.1);width:58px;height:28px;left:50%;margin-left:-29px}.player-olympic-player-next:hover .player-olympic-player-next-tip{display:block}.player-olympic-player-previous{width:24px;height:28px;background:url("http://static-image.1911edu.com/previous.png") 50% no-repeat;background-size:contain;float:left;margin-left:15px;margin-top:12px;cursor:pointer;position:relative}.player-olympic-player-previous-tip{position:absolute;top:-45px;display:none;font-size:12px;color:#fff;line-height:28px;letter-spacing:0;text-align:center;background:#3c3c3c;-webkit-box-shadow:0 0 5px 0 rgba(0,0,0,.1);box-shadow:0 0 5px 0 rgba(0,0,0,.1);width:58px;height:28px;left:50%;margin-left:-29px}.player-olympic-player-previous:hover .player-olympic-player-previous-tip{display:block}',""])},uiQa:function(e,t,a){"use strict";a.d(t,"a",function(){return i}),a.d(t,"b",function(){return r});var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{ref:"playInner",staticClass:"playInner",on:{click:e.playMedia,dblclick:e.dblclick}},[a("div",{ref:"mediaPlayer",staticClass:"prism-player",attrs:{id:"mediaPlayer"}}),a("div",{directives:[{name:"show",rawName:"v-show",value:e.playVideo,expression:"playVideo"}],ref:"playVideo",staticClass:"playVideo",on:{click:e.action}}),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isTrySee,expression:"isTrySee"}],staticClass:"isTrySee"},[e._v("试看"),a("span",[e._v(e._s(e.isTrySeeTime))]),e._v("分钟，观看完整版请"),a("span",{staticClass:"gobuy",on:{click:e.gobuy}},[e._v("购买")]),a("i",{staticClass:"el-icon-error",on:{click:e.closeTip}})]),a("v-error",{attrs:{showError:e.showError,errorMsg:e.errorMsg},on:{getPlayerInfo:e.getPlayerInfo}})],1)},r=[];i._withStripped=!0},vNYA:function(e,t,a){(e.exports=a("FZ+f")(!1)).push([e.i,".error[data-v-aa4ca744]{width:100%;position:absolute;top:0;bottom:0;left:0;right:0;background-color:#333;z-index:101}.error .errorMsg[data-v-aa4ca744]{width:80%;height:200px;background-color:#000;position:absolute;top:50%;left:50%;margin-top:-100px;margin-left:-40%;border-radius:10px}.error .errorMsg h5[data-v-aa4ca744]{height:52px;text-align:center;margin:40px 0;line-height:26px;padding:0 20px;color:#fff;font-size:16px}.error .errorMsg p[data-v-aa4ca744]{text-align:center;color:#fff;font-size:14px}.error .errorMsg p span[data-v-aa4ca744]{width:150px;height:40px;line-height:40px;border-radius:5px;background-color:#773084;margin:0 15px;cursor:pointer}.error .errorMsg p span[data-v-aa4ca744]:first-child{color:#666;background-color:#ddd}",""])},ygf3:function(e,t,a){"use strict";var i=a("Zrlr"),r=a.n(i),l=a("wxAW"),o=a.n(l),s=a("GpD0"),n=(a.n(s),function(){function e(t){r()(this,e),this.clickHandle=t,this.$html=$('<div class="player-olympic-player-next"><div class="player-olympic-player-next-tip">下一节</div></div>')}return o()(e,[{key:"createEl",value:function(e){this.$html.click(this.clickHandle),$(e).find(".prism-play-btn").after(this.$html)}}]),e}());t.a=n}});